(window.webpackJsonp=window.webpackJsonp||[]).push([[30],{"/nTe":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=s(a("vBSJ")),n=s(a("bS4n"));a("sRnv");var o=s(a("3vVk"));a("d8ex");function s(t){return t&&t.__esModule?t:{default:t}}e.default={components:{UploadTip:o.default},props:{value:{type:Array,default:function(){return[]}},fromSource:{type:Number,default:function(){return null}},supportSupplyType:{type:Array,defalut:function(){return[]}}},computed:{imageTypeOptions:function(){var t=this;return[{text:"在看",value:0},{text:"评论",value:1},{text:"点赞",value:2},{text:"转发",value:3},{text:"神回复",value:4}].filter((function(e){var a=t.supportSupplyType.find((function(t){return t===e.value}));return a||0===a}))},uploadOptions:function(){return{interface_type:"img",form_source:this.fromSource,isMultiUpload:!0}}},data:function(){return{images:this.value,typeObj:{looking:0,comment:1,like:2,forward:3,amazingReply:4},showUploadTypePop:!1,typeNumObj:{0:"looking",1:"comment",2:"like",3:"forward",4:"amazingReply"}}},watch:{value:function(t){this.images=t},images:function(t){this.$emit("input",t)}},methods:{chooseImages:function(){this.showUploadTypePop=!0},handleTypeChange:function(t,e){var a=this;this.images=this.images.map((function(i,o){return e===o?(0,n.default)({},i,{type:a.typeNumObj[t]}):i}))},imagePreview:function(t){(0,i.default)([t])},remove:function(t){this.images.splice(t,1)},uploadCallback:function(t){var e=this;console.log("callback",t),t&&t.length>0&&t.forEach((function(t){t.data.filePath?e.images.push({path:t.data.filePath,reducePath:t.data.filePath,id:null,type:e.typeNumObj[e.supportSupplyType[0].toString()]}):e.$toast.fail("上传失败, 请重新上传")}))},clickType:function(t){t.id&&this.$toast.fail("已提交的图片不支持修改")}}}},DsEa:function(t,e,a){},FFhL:function(t,e,a){"use strict";a("DsEa")},"J+5x":function(t,e,a){"use strict";a.r(e);var i=a("zSb0"),n=a("iVzQ");for(var o in n)["default"].indexOf(o)<0&&function(t){a.d(e,t,(function(){return n[t]}))}(o);a("uH7r");var s=a("gp09"),r=Object(s.a)(n.default,i.a,i.b,!1,null,null,null);e.default=r.exports},OFo1:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=m(a("EPZ6")),n=m(a("cLjf")),o=m(a("hDQ3")),s=m(a("bS4n")),r=a("dzbt"),u=m(a("7Qib")),l=m(a("tI4l")),c=m(a("TnDN")),p=m(a("+1ln"));function m(t){return t&&t.__esModule?t:{default:t}}e.default={components:{integralLimitTip:p.default,Upload:c.default},computed:(0,s.default)({},(0,r.mapState)(["uploadCapture"]),{articleType:function(){return 1===this.taskSupplyInfo.taskInfo.releaseType?"其它":this.taskSupplyInfo.taskInfo.urlType?l.default.urlType[this.taskSupplyInfo.taskInfo.urlType]:""},showTopBar:function(){var t=!0;return this.$route.query.hideTopbar&&(t=!1),t}}),data:function(){return{currentPlatform:{},uploadTypeSelected:"",form:{commentImages:[],likeImages:[],forwardImages:[],lookingImages:[]},imageLimit:{commentLimitNum:0,likeLimitNum:0,forwardLimitNum:0,lookingLimitNum:0,amazingReplyLimitNum:0},imageTypeTextObj:{comment:"评论截图",like:"点赞截图",forward:"转发截图",looking:"在看截图",amazingReply:"神回复截图"},imageList:[],uploaded:{comment:0,like:0,reforward:0},popType:"",processing:!1,showIntegralTip:!1,taskSupplyInfo:{taskInfo:{},supportSupplyType:[]},wechatShareId:null,allDone:!1}},created:function(){"Search"!==this.$route.query.from?(this.REMOVE_UPLOAD_CAPTURE(),this.wechatShareId=this.$route.query.wechatShareId):this.wechatShareId=this.uploadCapture.wechatShareId,this.wechatShareId&&this.loadSupplyInfo()},mounted:function(){var t=this;return(0,o.default)(n.default.mark((function e(){var a;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.$api.userIntegralExceedLimitRemind.isTips({isLoad:!1});case 2:a=e.sent,0==a.data&&(t.showIntegralTip=!0);case 5:case"end":return e.stop()}}),e,t)})))()},methods:(0,s.default)({},(0,r.mapMutations)(["REMOVE_UPLOAD_CAPTURE","SET_UPLOAD_CAPTURE"]),{loadSupplyInfo:function(){var t=this;return(0,o.default)(n.default.mark((function e(){var a,i;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.$api.wechatShareTaskCommon.queryTaskSupplyInfo({wechatShareId:t.wechatShareId});case 2:1!=(a=e.sent).code&&t.$toast.fail(a.message),t.imageList=[],i=a.data,t.taskSupplyInfo=i,t.imageLimit={commentLimitNum:i.commentLimitNum>0?i.commentLimitNum:0,likeLimitNum:i.likeLimitNum>0?i.likeLimitNum:0,forwardLimitNum:i.forwardLimitNum>0?i.forwardLimitNum:0,lookingLimitNum:i.lookingLimitNum>0?i.lookingLimitNum:0,amazingReplyLimitNum:i.amazingReplyLimitNum>0?i.amazingReplyLimitNum:0},["comment","like","forward","looking","amazingReply"].forEach((function(e){a.data[e+"UploadedInfo"].forEach((function(a){t.imageList.push({path:a.path,reducePath:a.reducePath,id:a.id,type:e})}))})),t.allDone=["comment","like","forward","looking","amazingReply"].every((function(e,i,n){return t.imageLimit[e+"LimitNum"]==a.data[e+"UploadedNum"]}));case 9:case"end":return e.stop()}}),e,t)})))()},onClickLeft:function(){"origin"!=this.$route.query.returnType?"Search"!=this.$route.query.from?this.$router.go(-1):this.$router.go(-2):this.backUp(window.location.href)},onClickRight:function(){this.$router.push({name:"UploadList"})},onChooseImages:function(){if(this.wechatShareId){var t=this.imageLimit,e=t.commentLimitNum,a=t.likeLimitNum,i=t.forwardLimitNum,n=t.lookingLimitNum,o=t.amazingReplyLimitNum;this.imageList.length>=e+a+i+n+o?this.$toast.fail("已超过图片上传限制张数"):this.$refs.upload.chooseImages()}else this.$toast.fail("补录文章不能为空")},limitNumTips:function(t){var e=this,a="";return(0,i.default)(this.imageTypeTextObj).forEach((function(i){t[i+"Images"].length>e.imageLimit[i+"LimitNum"]&&(a=e.imageTypeTextObj[i]+"仅允许上传"+e.imageLimit[i+"LimitNum"]+"张")})),a},onSubmit:function(){var t=this;return(0,o.default)(n.default.mark((function e(){var a,i,o;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.processing){e.next=3;break}return t.$toast.fail("请勿重复提交"),e.abrupt("return");case 3:if(t.processing=!0,u.default.isEmpty(t.wechatShareId,"补录文章不能为空")){e.next=26;break}if(!(t.imageList.length<1)){e.next=9;break}return t.$toast.fail("至少上传一个截图"),t.processing=!1,e.abrupt("return");case 9:if(a={commentImages:[],likeImages:[],forwardImages:[],lookingImages:[],amazingReplyImages:[]},t.imageList.forEach((function(t){a[t.type+"Images"].push(t)})),!(i=t.limitNumTips(a))){e.next=16;break}return t.$toast.fail(i),t.processing=!1,e.abrupt("return");case 16:return e.prev=16,e.next=19,t.$api.wechatShareTaskCommon.multiUpload((0,s.default)({isLoad:!0},a,{wechatShareId:t.wechatShareId}));case 19:o=e.sent,t.processing=!1,1==o.code?(t.$toast.success("保存成功"),t.REMOVE_UPLOAD_CAPTURE(),t.showTopBar?t.onClickLeft():t.wechatShareId&&t.loadSupplyInfo()):t.$toast.fail(o.message),e.next=26;break;case 24:e.prev=24,e.t0=e.catch(16);case 26:t.processing=!1;case 27:case"end":return e.stop()}}),e,t,[[16,24]])})))()},toSearch:function(){this.SET_UPLOAD_CAPTURE((0,s.default)({},this.uploadCapture)),this.$router.push({name:"Search",query:{from:"UploadCapture"}})},go2SupplyCase:function(){this.$router.push({name:"SupplyCase"})}})}},TnDN:function(t,e,a){"use strict";a.r(e);var i=a("cp0K"),n=a("q5Yf");for(var o in n)["default"].indexOf(o)<0&&function(t){a.d(e,t,(function(){return n[t]}))}(o);a("FFhL");var s=a("gp09"),r=Object(s.a)(n.default,i.a,i.b,!1,null,null,null);e.default=r.exports},WZtC:function(t,e,a){},cp0K:function(t,e,a){"use strict";a.d(e,"a",(function(){return i})),a.d(e,"b",(function(){return n}));var i=function(){var t=this,e=t._self._c;return e("div",{staticClass:"multi_upload_wrap"},[e("van-row",{attrs:{gutter:"14"}},[t._l(t.images,(function(i,n){return e("van-col",{key:n,attrs:{span:"12"}},[e("div",{staticClass:"uploaded_image_item"},[i.id?e("div",{staticClass:"has_upload"},[t._v("已提交")]):t._e(),t._v(" "),e("img",{staticClass:"thumb",attrs:{src:i.reducePath?i.reducePath:i.path,alt:""},on:{click:function(e){return t.imagePreview(i.path)}}}),t._v(" "),i.id?t._e():e("button",{staticClass:"btn_delete",on:{click:function(e){return t.remove(n)}}},[e("img",{attrs:{src:a("qYqz"),alt:""}})]),t._v(" "),e("div",{staticClass:"type_box",on:{click:function(e){return t.clickType(i)}}},[e("span",{staticClass:"label"},[t._v("类型：")]),t._v(" "),e("van-dropdown-menu",{attrs:{"active-color":"#0a72fe"}},[e("van-dropdown-item",{attrs:{value:t.typeObj[i.type],options:t.imageTypeOptions,disabled:!!i.id},on:{change:e=>t.handleTypeChange(e,n)}})],1)],1)])])})),t._v(" "),t.images&&t.images.length%2==1?e("van-col",{attrs:{span:"12"}}):t._e()],2),t._v(" "),e("UploadTip",{attrs:{uploadOptions:t.uploadOptions,uploadCallback:t.uploadCallback},model:{value:t.showUploadTypePop,callback:function(e){t.showUploadTypePop=e},expression:"showUploadTypePop"}})],1)},n=[]},iVzQ:function(t,e,a){"use strict";a.r(e);var i=a("OFo1"),n=a.n(i);for(var o in i)["default"].indexOf(o)<0&&function(t){a.d(e,t,(function(){return i[t]}))}(o);e.default=n.a},q5Yf:function(t,e,a){"use strict";a.r(e);var i=a("/nTe"),n=a.n(i);for(var o in i)["default"].indexOf(o)<0&&function(t){a.d(e,t,(function(){return i[t]}))}(o);e.default=n.a},qYqz:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcBAMAAACAI8KnAAAAMFBMVEUAAAB4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHh4eHj7/s+fAAAAD3RSTlMA7TOlPsrDYdyKIZVtRyey1Y1gAAAAoklEQVQY02MAAZZp8h8zHRiggL3/PxD8KIDwuOL/g8HXBWCu438oEAFr/A8HF4DchQiuHJAbj+B+BRr7HwkUMHAAyXB5IGEDxA0M/kAyQfH//88gI78wzAeSn5nk/xsoAhk/GfKBJJANFAHS3xiAJEh6gyKI/sgAMdIAKAkCaFw0xWhGoVmEcAYTyBlojkTzAqoH0byPFjioQYcWsBjBjhYpACdyCPzKSFhRAAAAAElFTkSuQmCC"},sRnv:function(t,e,a){"use strict";a.r(e);a("0GPk"),a("00cZ"),a("E8Wu"),a("HVE+"),a("Oe98"),a("lycV"),a("6B5o"),a("fBNp"),a("UZK1"),a("KHSm")},uH7r:function(t,e,a){"use strict";a("WZtC")},zSb0:function(t,e,a){"use strict";a.d(e,"a",(function(){return i})),a.d(e,"b",(function(){return n}));var i=function(){var t=this,e=t._self._c;return e("div",{staticClass:"upload_capture_wrap",class:{no_topbar:!t.showTopBar}},[e("van-nav-bar",{directives:[{name:"show",rawName:"v-show",value:t.showTopBar,expression:"showTopBar"}],attrs:{title:"　　"+t.$route.meta.title,"left-arrow":"","right-text":"补录详情",fixed:""},on:{"click-left":t.onClickLeft,"click-right":t.onClickRight}}),t._v(" "),e("div",{staticClass:"form"},[e("div",{staticClass:"row"},[t._m(0),t._v(" "),e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.taskSupplyInfo.taskInfo.title,expression:"taskSupplyInfo.taskInfo.title"}],staticClass:"article_title",staticStyle:{"background-color":"transparent"},attrs:{type:"text",autoHeight:"true",rows:"1",placeholder:"点击搜索文章",disabled:t.$route.query.wechatShareId},domProps:{value:t.taskSupplyInfo.taskInfo.title},on:{click:t.toSearch,input:function(e){e.target.composing||t.$set(t.taskSupplyInfo.taskInfo,"title",e.target.value)}}})]),t._v(" "),e("div",{staticClass:"row"},[t._m(1),t._v(" "),t.articleType?e("span",{staticClass:"text"},[t._v(t._s(t.articleType))]):e("span",{staticClass:"text gray"},[t._v("选择补录文章后自动填充")])]),t._v(" "),e("div",{staticClass:"image_limit_tips"},t._l(Object.keys(t.imageTypeTextObj),(function(a){return t.imageLimit[a+"LimitNum"]>0?e("span",[e("span","amazingReply"==a?[t._v("神回复仅允许上传"+t._s(t.imageLimit[a+"LimitNum"])+"张，且在人工核实后才能获得积分")]:[t._v(t._s(`${t.imageTypeTextObj[a]}允许上传${t.imageLimit[a+"LimitNum"]}张`)+"；")])]):t._e()})),0),t._v(" "),e("div",{staticClass:"supply_case_div",on:{click:t.go2SupplyCase}},[t._v("查看补录案例")]),t._v(" "),e("div",{staticClass:"row2"},[e("div",{staticClass:"uploads"},[e("Upload",{ref:"upload",attrs:{fromSource:1,supportSupplyType:t.taskSupplyInfo.supportSupplyType},model:{value:t.imageList,callback:function(e){t.imageList=e},expression:"imageList"}})],1)]),t._v(" "),t.allDone?e("div",{staticClass:"bottom_btn finished"},[t._v("已完成")]):e("div",{staticClass:"bottom_btn"},[e("div",{staticClass:"submit",on:{click:t.onChooseImages}},[t._v("选择图片")]),t._v(" "),e("div",{staticClass:"submit",on:{click:t.onSubmit}},[t._v("提交")])])]),t._v(" "),e("integral-limitTip",{model:{value:t.showIntegralTip,callback:function(e){t.showIntegralTip=e},expression:"showIntegralTip"}})],1)},n=[function(){var t=this._self._c;return t("div",{staticClass:"label"},[t("em",[this._v("*")]),this._v("补录文章")])},function(){var t=this._self._c;return t("div",{staticClass:"label"},[t("em",[this._v("*")]),this._v("文章类型")])}]}}]);