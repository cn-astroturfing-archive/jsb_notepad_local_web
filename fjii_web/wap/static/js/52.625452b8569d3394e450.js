(window.webpackJsonp=window.webpackJsonp||[]).push([[52],{"7iVr":function(e,t,s){},JLFP:function(e,t,s){"use strict";s.r(t);var a=s("ZEEL"),o=s.n(a);for(var n in a)["default"].indexOf(n)<0&&function(e){s.d(t,e,(function(){return a[e]}))}(n);t.default=o.a},ROws:function(e,t,s){"use strict";s.d(t,"a",(function(){return a})),s.d(t,"b",(function(){return o}));var a=function(){var e=this,t=e._self._c;return t("div",{staticClass:"login_wrap default_login_wrap"},[t("div",{class:{free_login:1===e.loginType,logo:!0}}),e._v(" "),t("div",{staticClass:"title"},[e._v("通信头条")]),e._v(" "),t("div",{staticClass:"page-infos"},[t("div",{staticClass:"back",on:{click:e.goback}},[t("span",{staticClass:"back_ing"}),e._v(" "),t("span",{staticClass:"go_back"},[e._v("返回")])]),e._v(" "),t("div",{staticStyle:{"font-size":"18px"}},[e._v("欢迎您，登录解锁更多精彩内容")]),e._v(" "),t("div",{staticStyle:{color:"#fffc01","font-size":"14px"}},[e._v("未注册的手机号验证通过后将自动注册")])]),e._v(" "),t("form",[t("div",{staticClass:"form"},[t("input",{staticStyle:{display:"none"},attrs:{type:"password"}}),e._v(" "),t("div",{staticClass:"row"},[1===e.loginType?[t("div",{staticClass:"login_btn btn_auth",on:{click:e.authLogin}},[e._v("天翼号免密登录")])]:e._e(),e._v(" "),2===e.loginType?[t("div",{staticClass:"input",class:{active:"username"===e.keyborderType}},[t("div",{key:"username",staticClass:"value",on:{click:function(t){return t.stopPropagation(),e.toggleKeyborad(!0,"username")}}},[t("span",[e._v(e._s(e.form.username))]),e._v(" "),t("span",{staticClass:"line"}),e._v(" "),e.form.username?e._e():t("span",{staticClass:"placeholder"},[e._v("请输入帐号")])]),e._v(" "),t("img",{staticClass:"icon_phone",attrs:{src:s("D7v5"),alt:"",srcset:""}})]),e._v(" "),t("div",{staticClass:"input",class:{active:"password"===e.keyborderType}},[t("div",{key:"password",staticClass:"value",on:{click:function(t){return t.stopPropagation(),e.toggleKeyborad(!0,"password")}}},[e.showPwd?t("span",[e._v(e._s(e.form.password))]):t("span",[e._v(e._s(e._f("password")(e.form.password)))]),e._v(" "),t("span",{staticClass:"line"}),e._v(" "),e.form.password?e._e():t("span",{staticClass:"placeholder"},[e._v("请输入密码")])]),e._v(" "),t("img",{staticClass:"icon_password",attrs:{src:s("Srsz"),alt:"",srcset:""}}),e._v(" "),t("button",{staticClass:"btn_view_pwd",class:{active:e.showPwd},attrs:{type:"button"},on:{click:e.toggleViewPwd}})]),e._v(" "),t("div",{staticClass:"input code",class:{active:"imageCode"===e.keyborderType}},[t("div",{key:"imageCode",staticClass:"value",on:{click:function(t){return t.stopPropagation(),e.toggleKeyborad(!0,"imageCode")}}},[t("span",[e._v(e._s(e.form.imageCode))]),e._v(" "),t("span",{staticClass:"line"}),e._v(" "),e.form.imageCode?e._e():t("span",{staticClass:"placeholder"},[e._v("请输入验证码")])]),e._v(" "),t("img",{staticClass:"icon_code",attrs:{src:s("/3q8"),alt:"",srcset:""}}),e._v(" "),t("a",{staticClass:"send_code_btn",attrs:{href:"javascript:;"},on:{click:function(t){return e.flushImageCode(!0)}}},[t("img",{attrs:{id:"image_code",src:e.imageCodeSrc,alt:""}})])]),e._v(" "),t("div",{staticClass:"login_btn",on:{click:e.login}},[e._v("登录")])]:e._e(),e._v(" "),3===e.loginType?[t("div",{staticClass:"input",class:{active:"phoneNum"===e.keyborderType}},[t("div",{key:"phoneNum",staticClass:"value",on:{click:function(t){return t.stopPropagation(),e.toggleKeyborad(!0,"phoneNum")}}},[t("span",[e._v(e._s(e.form.phoneNum))]),e._v(" "),t("span",{staticClass:"line"}),e._v(" "),e.form.phoneNum?e._e():t("span",{staticClass:"placeholder"},[e._v("请输入手机号码")])]),e._v(" "),t("img",{staticClass:"icon_phone",attrs:{src:s("D7v5"),alt:"",srcset:""}})]),e._v(" "),t("div",{staticClass:"input code",class:{active:"smsCode"===e.keyborderType}},[t("div",{key:"smsCode",staticClass:"value",on:{click:function(t){return t.stopPropagation(),e.toggleKeyborad(!0,"smsCode")}}},[t("span",[e._v(e._s(e.form.smsCode))]),e._v(" "),t("span",{staticClass:"line"}),e._v(" "),e.form.smsCode?e._e():t("span",{staticClass:"placeholder"},[e._v("请输入验证码")])]),e._v(" "),t("img",{staticClass:"icon_code",attrs:{src:s("/3q8"),alt:"",srcset:""}}),e._v(" "),t("a",{staticClass:"send_code_btn phone_code",class:{disable:e.sent},attrs:{href:"javascript:;"},on:{click:e.sendMsgCode}},[e._v(e._s(e.sent?e.sentText:"发送验证码"))])]),e._v(" "),t("div",{staticClass:"login_btn",on:{click:e.login}},[e._v("登录")])]:e._e()],2),e._v(" "),t("div",{staticClass:"toggle_btns"},[1!==e.loginType?t("span",{staticClass:"toggle_btn",on:{click:function(t){return e.toggleLogintype(1)}}},[e._v("天翼号免密登录")]):e._e(),e._v(" "),3!==e.loginType?t("span",{staticClass:"toggle_btn",on:{click:function(t){return e.toggleLogintype(3)}}},[e._v("短信验证码登录")]):e._e(),e._v(" "),2!==e.loginType?t("span",{staticClass:"toggle_btn",on:{click:function(t){return e.toggleLogintype(2)}}},[e._v("账号密码登录")]):e._e()]),e._v(" "),t("div",{staticClass:"row"},[t("div",{staticClass:"protocol"},[t("van-checkbox",{attrs:{"checked-color":"rgba(96, 187, 255, 0.94)",shape:"square"},model:{value:e.agreeProtocol,callback:function(t){e.agreeProtocol=t},expression:"agreeProtocol"}},[e._v("\n\t\t\t\t\t\t\t我已阅读并同意使用\n\t\t\t\t\t\t\t"),t("router-link",{staticClass:"color:white;",attrs:{to:{name:"Protocol"}}},[e._v("用户协议")]),e._v("、\n\t\t\t\t\t\t\t"),t("router-link",{attrs:{to:{name:"Secret"}}},[e._v("隐私政策")])],1)],1)])])]),e._v(" "),t("van-dialog",{attrs:{title:"温馨提示","show-cancel-button":"",cancelButtonColor:"#4c4c4c",confirmButtonColor:"#f7b637",confirmButtonText:"我同意","before-close":e.closeFirstOpen},model:{value:e.showFisrtOpen,callback:function(t){e.showFisrtOpen=t},expression:"showFisrtOpen"}},[t("div",{staticClass:"tips_text"},[t("p",[e._v("通信头条非常重视您的隐私和个人信息方面的保护。在您使用通信头条之前，请认真阅读通信头条《基本功能隐私政策》和《用户协议》，您同意并接受相关条款后方可开始使用通信头条的基本功能。")]),e._v(" "),t("p",[e._v("根据《常见类型移动互联网应用程序必要个人信息范围规定》通信头条 APP属于新闻资讯类，基本功能为新闻资讯的浏览、搜索，无须个人信息，即可使用基本功能服务，同意效力仅代表授权基本功能收集必要个人信息，其它功能收集个人信息将在用户使用时单独征求用户同意。")]),e._v(" "),t("van-checkbox",{attrs:{"checked-color":"rgba(96, 187, 255, 0.94)",shape:"square"},model:{value:e.agreeProtocol,callback:function(t){e.agreeProtocol=t},expression:"agreeProtocol"}},[e._v("我已阅读并同意使用\n\t\t\t\t\t"),t("router-link",{attrs:{to:{name:"Protocol"}}},[e._v("用户协议")]),e._v("、\n\t\t\t\t\t"),t("router-link",{attrs:{to:{name:"SecretBase"}}},[e._v("基本功能隐私政策")])],1)],1)]),e._v(" "),t("van-dialog",{attrs:{title:"温馨提示","show-cancel-button":"",cancelButtonColor:"#4c4c4c",confirmButtonColor:"#f7b637",cancelButtonText:"不同意",confirmButtonText:"我同意","before-close":e.protocolDialogClose},model:{value:e.showProtocolDialog,callback:function(t){e.showProtocolDialog=t},expression:"showProtocolDialog"}},[t("div",{staticClass:"tips_text"},[t("p",[t("span",[e._v("为了更好地保障您的合法权益，请您阅读并同意以下协议")]),t("router-link",{attrs:{to:{name:"Protocol"}}},[e._v("用户协议")]),e._v("、"),t("router-link",{attrs:{to:{name:"SecretBase"}}},[e._v("基本功能隐私政策")])],1)])]),e._v(" "),t("keyboard",{ref:"MyKeyboard",attrs:{show:e.showKeyborad},on:{changed:e.changed,hide:e.hide},model:{value:e.keyboardInput,callback:function(t){e.keyboardInput=t},expression:"keyboardInput"}})],1)},o=[]},Srsz:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACEAAAAkCAQAAACtIJtXAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAAmJLR0QAAKqNIzIAAAAHdElNRQfkBg8XDCbx82nGAAACE0lEQVRIx+XUO2hTYRiA4eekiW2CiHYoikgGA7bOUpG6WETUoRURcfA2ipdadCy4KIigVnBw8YKjgtCKd4koiKhgXXSwoLXioJaitYVWTI1D0mKak7TJ6jt+5/tfvsv/nyAtlIRGbZotFjNp2Gu39PlZnNgqCFU0O2i72hnRB865W6yIhAh26rUrL/hlzHg+vkGPIxIz06NFgk4n1YHbnvpkQkyDNdolzHNGo8PTUihqpN01tXjvhB4/puMx63VpAcccLz2LpR5L4ZX9XhbVl3TWVoxbq6/ULNqk8EFHiIBBR7xA3N5/w4WKTeCRZ8IZdCPf7qJwRYNVGHVHaXq9QdzC8I2kLMCA52UU/brsdtdAuCIhwJgvynHTzcJATrFEmyYr1SLlkomQ+zJFVkaNGpP63fc2dy82OK1RTKVkvdftQpBeLi1Z8fEpxrVH7ZTEd3cMiArmeDSj3mZJcQei1oFTTlVcwR5XBFZE8k9qqIomRv1GEPEHymyg9JgjAmQjyrPRdUfzlZY0laPeUVuc1FS9Iq4esX9fRKWKrN8gU71iTvw3imD2rMgsgpwiW73iqyd+eeZDuaRoWUXGCff0+1xekSt1ssT3EemSZ7O5BiN5xVx/NYU1RlAT9c5q7PDRUAUr/mO+baIYCdItHorjm5EKasmqswzsC9J06q6ijRwXHYrivEEdkmbZfwEBhl11uXXiL9DPf9Ps6MBRAAAAAElFTkSuQmCC"},ZEEL:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=u(s("omC7")),o=u(s("cLjf")),n=u(s("hDQ3")),r=u(s("bS4n")),i=s("dzbt"),c=u(s("7Qib")),l=u(s("mIWY"));function u(e){return e&&e.__esModule?e:{default:e}}t.default={components:{keyboard:l.default},data:function(){return{keyborderType:"",keyboardInput:"",showKeyborad:!1,sent:!1,sentText:"",form:{accessToken:"",imageCode:"",username:"",password:"",phoneNum:"",smsCode:""},imageCodeSrc:"",showForm:!0,tempUserName:"",tempPassword:"",isAutoFill:!1,loginType:1,showFisrtOpen:!1,agreeProtocol:!1,showPwd:!1,versionType:"",showProtocolDialog:!1,nextStep:""}},computed:(0,i.mapState)(["userInfo"]),watch:{"form.smsCode":function(e){e.length>6&&(this.form.smsCode=e.slice(0,6))}},created:function(){this.userInfo.token?this.$router.replace({name:"TasksHome"}):(this.flushImageCode(!1),"1"===this.$route.query.first_open&&(this.showFisrtOpen=!0)),this.$nextTick((function(){var e=this,t=document.cookie;(t=t.split(";")).forEach((function(t){var s=t.split("=");s[0]=s[0].trim(),"u"===s[0]&&(e.form.username=e.tempUserName=s[1]),"p"===s[0]&&(e.tempPassword=s[1],e.form.password="temppawd"),"v"===s[0]&&(e.versionType=s[1])})),this.form.username&&this.form.password?this.isAutoFill=!0:this.isAutoFill=!1}))},mounted:function(){var e=this;window.needRefreshSquare=!0,window.needRefreshToutiao=!0,window.needRefreshLocal=!0,window.refreshVideoListPage=!0,document.body.querySelector(".login_wrap").addEventListener("click",(function(t){var s=t.target;if(null!=s){if("IMG"==s.tagName&&s.id&&"image_code"==s.id)return;"BUTTON"!==s.tagName&&e.hide()}}))},methods:(0,r.default)({toggleKeyborad:function(e,t){if(this.showKeyborad=e,e){var s="lower-case",a=18;"phoneNum"==t?(s="number",a=11):"smsCode"==t?(s="number",a=6):"imageCode"==t&&(a=4),this.$refs.MyKeyboard.showSpecialKeyword(s),this.$refs.MyKeyboard.changeMaxLength(a),this.keyborderType=t,this.keyboardInput=this.form[t]}else this.keyborderType=""},hide:function(e){this.toggleKeyborad(!1)},changed:function(e){this.keyborderType&&(this.form[this.keyborderType]=e)},goback:function(){1==this.loginType?(this.SET_LOGIN_THEN_OPEN_DUIBA_STORE(!1),this.$router.push({name:"TasksHome"})):this.loginType=1}},(0,i.mapMutations)(["SET_USERINFO","SET_HINT_FLAG","REMOVE_CERT_INFO","SET_LOGIN_THEN_OPEN_DUIBA_STORE"]),{toggleLogintype:function(e){this.loginType=e},login:function(){var e=this;return(0,n.default)(o.default.mark((function t(){var s,a,n,i,l,u,d,p,f,m,g,v,h,_,b,k,y;return o.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.agreeProtocol){t.next=4;break}return e.nextStep="login",e.showProtocolDialog=!0,t.abrupt("return");case 4:if(e.clearTime(),s=e.form,a=s.username,n=s.password,i=s.imageCode,l=s.phoneNum,u=s.smsCode,t.prev=6,(2!==e.loginType||c.default.isEmpty(a,"请输入帐号")||c.default.isEmpty(n,"请输入密码")||c.default.isEmpty(i,"请输入验证码"))&&(3!==e.loginType||c.default.isEmpty(l,"请输入手机号码")||!c.default.isMobile(l,"请输入正确的手机号码")||c.default.isEmpty(u,"请输入短信验证码"))){t.next=24;break}return e.$bus.emit("showLoad"),d={},2===e.loginType?(p=e.isAutoFill&&e.tempUserName===e.form.username&&"temppawd"===e.form.password,n=p?e.tempPassword:c.default.SHA1(n),f=/^[0-9]+.?[0-9]*$/,m=void 0,m=11==e.form.username.length&&f.test(e.form.username)?1:0,g=c.default.defaultEncryptRetBase64(e.form.username),d={imageCode:i,username:g,password:n,isPhoneByName:m},p||((v=new Date).setTime(v.getTime()+6048e5),h="expires="+v.toGMTString(),document.cookie="u="+a+";"+h,document.cookie="p="+n+";"+h)):(l=c.default.defaultEncryptRetBase64(l),d={phoneNum:l,smsCode:u}),t.next=13,e.$api.login.login((0,r.default)({isLoad:!1},d));case 13:_=t.sent,b=_.data,e.REMOVE_CERT_INFO(),e.SET_USERINFO(_.data),e.SET_HINT_FLAG(_.data.hintFlag);try{e.appPushToken(_.data.token),e.userAgreement()}catch(e){}try{k=_.data.userId,k=c.default.defaultEncryptRetBase64(k),y=_.data.username,e.setLoginUser({userId:k,username:y,name:res.data.name})}catch(e){}e.fetchFullDepartmentName(b),e.$bus.emit("hideLoad"),e.$api.activity.insertDayLoginData({deviceId:""}).then((function(e){})),e.$router.push({name:"TasksHome"});case 24:t.next=29;break;case 26:t.prev=26,t.t0=t.catch(6),e.$bus.emit("hideLoad");case 29:case"end":return t.stop()}}),t,e,[[6,26]])})))()},fetchFullDepartmentName:function(e){var t=this,s=this;setTimeout((0,n.default)(o.default.mark((function a(){var n;return o.default.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,t.$api.heroes.getOrgByUser({isLoad:!1});case 2:n=a.sent,e.fullDepartmentName=n.message,s.SET_USERINFO(e);case 5:case"end":return a.stop()}}),a,t)}))),1e3)},flushImageCode:function(e){var t=this;return(0,n.default)(o.default.mark((function s(){var a;return o.default.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,t.$api.login.getImageCode({isLoad:!1});case 2:a=s.sent,t.imageCodeSrc=a.data.url,t.form.imageCode="",e&&t.toggleKeyborad(!0,"imageCode"),t.$refs.MyKeyboard.clear();case 7:case"end":return s.stop()}}),s,t)})))()},sendMsgCode:function(){var e=this;return(0,n.default)(o.default.mark((function t(){var s,a;return o.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.sent&&!c.default.isEmpty(e.form.phoneNum,"请输入手机号码")){t.next=2;break}return t.abrupt("return");case 2:if(c.default.isMobile(e.form.phoneNum,"请输入正确的手机号码")){t.next=4;break}return t.abrupt("return");case 4:if(e.agreeProtocol){t.next=8;break}return e.nextStep="sendMsgCode",e.showProtocolDialog=!0,t.abrupt("return");case 8:return t.prev=8,e.$toast.loading(),e.sent=!0,t.next=13,e.$api.login.getPhoneNum({isLoad:!1,phoneNum:c.default.defaultEncryptRetBase64(e.form.phoneNum)});case 13:"成功"===(s=t.sent).message?(e.$toast.success("短信验证码已发送"),a=60,e.sentText=a+"S",e.time=setInterval((function(){1===a?(e.sent=!1,clearInterval(e.time)):(--a,e.sentText=a+"S")}),1e3)):(e.sent=!1,e.$toast.success(s.message)),t.next=20;break;case 17:t.prev=17,t.t0=t.catch(8),setTimeout((function(){e.$toast.clear(),e.sent=!1}),3e3);case 20:case"end":return t.stop()}}),t,e,[[8,17]])})))()},clearTime:function(){if(this.time){clearInterval(this.time),this.sent=!1;this.sentText="60S"}},authLogin:function(){var e,t=this;if(!this.agreeProtocol)return this.nextStep="authLogin",void(this.showProtocolDialog=!0);this.passwordFreeLogin((e=(0,n.default)(o.default.mark((function e(s,n){var i,l,u,d,p;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{t.$api.login.addErrorByMessage({isLoad:!1,message:(0,a.default)({os:c.default.getOS(),date:new Date,result:n})})}catch(e){}if(s.accessToken){e.next=24;break}if(80200==(i=JSON.parse(n)).result){e.next=23;break}if("-10008"!==i.result){e.next=8;break}t.$toast.fail("暂不支持非电信手机号码免密登录"),e.next=23;break;case 8:if("-7002"!==i.result){e.next=12;break}t.$toast.fail("用户取消登录"),e.next=23;break;case 12:l="",e.t0=i.msg,e.next="over-limit"===e.t0?16:"退出登录，关闭webview"===e.t0?18:20;break;case 16:return l="当前手机号码不支持免密登录",e.abrupt("break",22);case 18:return l="用户取消登录",e.abrupt("break",22);case 20:return l=i.msg,e.abrupt("break",22);case 22:t.$toast.fail(l);case 23:return e.abrupt("return");case 24:return t.form.accessToken=s.accessToken,t.$bus.emit("showLoad"),u={},e.prev=27,e.next=30,t.$api.login.login((0,r.default)({isLoad:!1},t.form,{versionType:t.versionType}));case 30:u=e.sent,t.REMOVE_CERT_INFO(),t.SET_USERINFO(u.data),t.SET_HINT_FLAG(u.data.hintFlag);try{t.appPushToken(u.data.token),t.userAgreement()}catch(e){}try{d=u.data.userId,d=c.default.defaultEncryptRetBase64(d),p=u.data.username,t.setLoginUser({userId:d,username:p,name:u.data.name})}catch(e){}t.$bus.emit("hideLoad"),t.$api.activity.insertDayLoginData({deviceId:""}).then((function(e){})),t.$router.push({name:"TasksHome"}),e.next=44;break;case 41:e.prev=41,e.t1=e.catch(27),t.$bus.emit("hideLoad");case 44:case"end":return e.stop()}}),e,t,[[27,41]])}))),function(t,s){return e.apply(this,arguments)}))},closeFirstOpen:function(e,t){"confirm"===e?this.agreeProtocol?(this.userAgreement(),t()):(this.$toast.fail("请先阅读并同意用户协议和隐私政策"),t(!1)):this.showFisrtOpen=!1},protocolDialogClose:function(e,t){"confirm"===e?(this.agreeProtocol=!0,this.nextStep&&this[this.nextStep].bind(this)(),t()):(this.nextStep="",this.showProtocolDialog=!1,t(!1))},toggleViewPwd:function(){this.showPwd=!this.showPwd}})}},cQHI:function(e,t,s){"use strict";s.r(t);var a=s("ROws"),o=s("JLFP");for(var n in o)["default"].indexOf(n)<0&&function(e){s.d(t,e,(function(){return o[e]}))}(n);s("vFdl");var r=s("gp09"),i=Object(r.a)(o.default,a.a,a.b,!1,null,null,null);t.default=i.exports},vFdl:function(e,t,s){"use strict";s("7iVr")}}]);