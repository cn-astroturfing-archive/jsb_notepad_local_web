(window.webpackJsonp=window.webpackJsonp||[]).push([[35],{"9dhk":function(t,e,a){},T4bl:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAADICAMAAACahl6sAAAAXVBMVEUAAACHh4eJiYmKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqIiIiKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqIiIiKioqKioqKioqKioqKiorFa0xbAAAAHnRSTlMAQIC/HwjG8aiMmGVGF82ybuDVdZ+TNOi6EFxMVSpgbgijAAADEElEQVR42u3ciXKiQBSF4W5kk0VRXKOe93/MScaYhEA3S2XMvcz5XkB/LZruWxSGiIiIiIiIiIj+c1aBQSEBxAsYIgxDpGGINAyRhiHSMEQahkgzKWRhBFgwhCF/MYQhDPFjCEMY4scQhjCky6Fapqd1FthIc0i4P+IhWVu1IdUGDctIZ8gS361CjSFbdLD6QjboVGoL2aHbOtIVcoXLUlVItIKT1RQSwG2tKWQNj0hPSASfQk+IhU+gJySHT6onZA+frZ6QBbz0hMzmH5nNNTKbVcsk8LCKQlK4HU2fs5yQHG5Z/zdMxYR4FuDkNuCIXIgJuU6/1F/easWETD8hHvBmKSZk8pl9i78OYkImTlFS3G3lhEyaa9V4qOWEmHyFr45BZHoU+HSTE/KacsJDHJSmT5ngUywpxJjwfRp/MwPE+CoXFTLGHk2h0pAc36Q6Qw5oedEYEm3QFioMWaNDpi8kQKertpALum1KXSEhXPa6QmI4XTSFZHBbnfWE5PBZqgmx8LsoCYk28IsjHSFr9AlUhAToZxWEXOGxyuoRTxU9IWQXuu+EHvejsaCQ2n1sXcHtYF5JCrkACHrGeM4tvKCQMHH+vBXQu8mSExLjzWbknfBk7uSE7Jw7jfNxyIorJaR2P/BwGvSch5CQAh+S1kTVY2XeCQkJE+d05wU+O/MgIyR2TnduQ7dXIkJ2aDqbD1tNIbV7TU2hKKRAS/WRqCgkTJz7jgKaQmLnslommkIy9zdcQFFI5d6c76EopIDLJoeikDCBm6aQGD8bYhdNzwrJ8NMhaHpSSIV5hBSYR0iZzCQkxnjbNGgSEJJhrLRrmvjrIRUGaB235IUUGOtsJIaMv9BrIzIkxkixERmSYSwrMqTCWLGRGGIx2lJiSHnEaBeJIQuMdxYYkmECIy8kxzxCLOYRUh5nErKYaPB7xNHU93JvEe9FCebyekOGMOSOIQxhCEMYwhCGvGLI7EMmH6wY4sGQp4fYn/HrIW1KpygMYQhDGMIQhjCEIQxhyIxD7L8x9eMNERERERERERFRyx9tlwFD2OO5xAAAAABJRU5ErkJggg=="},nR3o:function(t,e,a){"use strict";a("9dhk")},vXG7:function(t,e,a){"use strict";a.d(e,"a",(function(){return o})),a.d(e,"b",(function(){return i}));var o=function(){var t=this,e=t._self._c;return e("div",{staticClass:"column-management"},[e("van-nav-bar",{attrs:{title:t.$route.meta.title,"left-arrow":"",fixed:""},on:{"click-left":t.onClickLeft}}),t._v(" "),e("van-form",{on:{submit:t.sumbitDebounce}},[e("van-field",{attrs:{required:"",rows:"3",autosize:"",type:"textarea",label:"专栏标题",placeholder:"专栏标题",rules:[{required:!0,message:"请输入专栏标题"}]},model:{value:t.formData.subjectName,callback:function(e){t.$set(t.formData,"subjectName",e)},expression:"formData.subjectName"}}),t._v(" "),e("van-field",{attrs:{readonly:"",clickable:"",required:"",value:t.Dict.subjectCatrgory[t.formData.category],label:"专栏类别",placeholder:"请选择","is-link":"",disabled:!0}}),t._v(" "),e("van-field",{attrs:{readonly:"",clickable:"",required:"",value:t.$options.filters.formatIndateType(t.formData.indateType),label:"有效期类型",placeholder:"请选择有效期","is-link":""},on:{click:function(e){t.showIndateTypePicker=!0}}}),t._v(" "),9==t.formData.indateType?e("van-field",{attrs:{required:9==t.formData.indateType,type:"digit",label:"有效时长",placeholder:"请填写数字，不能超过72",rules:t.expireAfterHoursRules},model:{value:t.formData.expireAfterHours,callback:function(e){t.$set(t.formData,"expireAfterHours",e)},expression:"formData.expireAfterHours"}},[e("template",{slot:"extra"},[t._v("\n          小时\n      ")])],2):t._e(),t._v(" "),e("van-field",{attrs:{label:"是否置顶"},scopedSlots:t._u([{key:"input",fn:function(){return[e("van-switch",{model:{value:t.formData.isTop,callback:function(e){t.$set(t.formData,"isTop",e)},expression:"formData.isTop"}})]},proxy:!0}])}),t._v(" "),e("van-field",{attrs:{label:"是否启用"},scopedSlots:t._u([{key:"input",fn:function(){return[e("van-switch",{model:{value:t.formData.status,callback:function(e){t.$set(t.formData,"status",e)},expression:"formData.status"}})]},proxy:!0}])}),t._v(" "),e("van-field",{attrs:{label:"专栏缩略图",required:"",value:t.formData.coverImg,rules:[{required:!0,message:"请选取或上传缩略图"}]},scopedSlots:t._u([{key:"input",fn:function(){return[e("van-button",{attrs:{type:"info",size:"small",plain:"","native-type":"button"},on:{click:function(e){t.showThumbSelect=!0}}},[t._v("\n          选取缩略图\n        ")]),t._v(" "),e("span",[t._v(" ")]),t._v(" "),e("van-button",{attrs:{type:"info",size:"small",plain:"","native-type":"button"},on:{click:t.deleteThumb}},[t._v("\n          删除缩略图\n        ")])]},proxy:!0}])}),t._v(" "),t.formData.coverImg?e("div",{staticClass:"upload-img",on:{click:t.onToUpload}},[e("img",{attrs:{src:t.formData.coverImg,alt:""}})]):e("div",{staticClass:"no-upload-img",on:{click:t.onToUpload}},[e("img",{attrs:{src:a("T4bl"),alt:""}}),t._v(" "),e("p",[t._v("点击上传自定义缩略图")])]),t._v(" "),e("div",{staticClass:"sumbit-btn-box"},[e("van-button",{attrs:{block:"",type:"info","native-type":"submit"}},[t._v(" 提交 ")])],1)],1),t._v(" "),e("van-popup",{attrs:{position:"bottom"},model:{value:t.showIndateTypePicker,callback:function(e){t.showIndateTypePicker=e},expression:"showIndateTypePicker"}},[e("van-picker",{attrs:{title:"","show-toolbar":"",columns:t.indateTypes},on:{confirm:t.onIndateTypesConfirm,cancel:function(e){t.showIndateTypePicker=!1}}})],1),t._v(" "),e("van-popup",{attrs:{position:"bottom"},model:{value:t.showSubjectCatrgoryPicker,callback:function(e){t.showSubjectCatrgoryPicker=e},expression:"showSubjectCatrgoryPicker"}},[e("van-picker",{attrs:{title:"","show-toolbar":"",columns:t.subjectCatrgory},on:{confirm:t.onSubjectCatrgoryConfirm,cancel:function(e){t.showSubjectCatrgoryPicker=!1}}})],1),t._v(" "),e("van-popup",{staticClass:"thumb-popup",attrs:{position:"bottom"},model:{value:t.showThumbSelect,callback:function(e){t.showThumbSelect=e},expression:"showThumbSelect"}},[e("div",{staticClass:"thumb-box"},[t._l(5,(function(a){return[e("van-radio",{attrs:{name:"item"},on:{click:function(e){return t.selectThumb(`/jsb-files/default_img/zhuanlan_0${a}.png`)}}},[e("img",{attrs:{src:`/jsb-files/default_img/zhuanlan_0${a}.png`,alt:"",srcset:""}})])]}))],2)]),t._v(" "),e("UploadTip",{attrs:{uploadOptions:t.uploadOptions,uploadCallback:t.uploadCallback},model:{value:t.showUploadPop,callback:function(e){t.showUploadPop=e},expression:"showUploadPop"}})],1)},i=[]},wCUD:function(t,e,a){"use strict";a.r(e);var o=a("vXG7"),i=a("wvkQ");for(var n in i)["default"].indexOf(n)<0&&function(t){a.d(e,t,(function(){return i[t]}))}(n);a("nR3o");var r=a("gp09"),s=Object(r.a)(i.default,o.a,o.b,!1,null,"2b3f3497",null);e.default=s.exports},wvkQ:function(t,e,a){"use strict";a.r(e);var o=a("zrY1"),i=a.n(o);for(var n in o)["default"].indexOf(n)<0&&function(t){a.d(e,t,(function(){return o[t]}))}(n);e.default=i.a},zrY1:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=l(a("cLjf")),i=l(a("hDQ3")),n=l(a("bS4n")),r=l(a("tI4l")),s=a("fJgZ"),u=a("dzbt"),c=l(a("3vVk"));function l(t){return t&&t.__esModule?t:{default:t}}e.default={components:{UploadTip:c.default},data:function(){var t=r.default.indateTypes.map((function(t){return{value:t.value,text:t.label}}));return{formData:{subjectName:"",indateType:1,isTop:!1,status:!0,coverImg:"/jsb-files/default_img/zhuanlan_0"+(Math.floor(5*Math.random())+1)+".png",category:""},Dict:r.default,indateTypes:t,showIndateTypePicker:!1,showThumbSelect:!1,selectDefalutThumb:"",subjectCatrgory:[],showSubjectCatrgoryPicker:!1,showUploadPop:null,uploadOptions:{},expireAfterHoursRules:[{required:!0,message:"自定义有效时长不能为空"},{trigger:["onBlur","onChange"],message:"请输入正确的内容",validator:function(t){return!!t&&(!!/^\d{1,2}$/.test(t)&&!(t<1||t>72))}}]}},computed:(0,n.default)({},(0,u.mapGetters)(["permissions"]),{sumbitDebounce:function(){return(0,s.debounce)(this.onSubmit,500)}}),filters:{formatIndateType:function(t){for(var e=r.default.indateTypes.length,a=0;a<e;a++)if(r.default.indateTypes[a].value==t)return r.default.indateTypes[a].label;return""}},mounted:function(){var t=[];if(this.permissions.includes("app:toutiao_subject:manage")){t.push({value:1,text:r.default.subjectCatrgory[1]})}if(this.permissions.includes("app:local_subject:manage")){t.push({value:2,text:r.default.subjectCatrgory[2]})}this.subjectCatrgory=t,this.$route.query.id?this.subjectDetail():this.permissions.includes("app:toutiao_subject:manage")?this.formData.category="1":this.permissions.includes("app:local_subject:manage")&&(this.formData.category="2")},methods:{subjectDetail:function(){var t=this;return(0,i.default)(o.default.mark((function e(){var a,i;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.$api.wechatShareTaskSubjects.subjectBasicInfo({id:t.$route.query.id});case 2:a=e.sent,i=a.data,t.formData=(0,n.default)({},i,{isTop:!!i.isTop,status:!!i.status});case 5:case"end":return e.stop()}}),e,t)})))()},onClickLeft:function(){this.$router.go(-1)},onIndateTypesConfirm:function(t){this.formData.indateType=t.value,this.showIndateTypePicker=!1},onSubjectCatrgoryConfirm:function(t){this.formData.category=t.value,this.showSubjectCategoryPicker=!1},selectThumb:function(t){this.formData.coverImg=t,this.showThumbSelect=!1},deleteThumb:function(){this.formData.coverImg=""},onToUpload:function(){this.uploadOptions={type:"photo",interface_type:"img",form_source:4},this.showUploadPop=Math.random()},uploadCallback:function(t){var e=t.code,a=t.data,o=t.message;e&&1==e&&a.filePath?this.formData.coverImg=a.filePath:this.$toast.fail(o||"上传失败, 请重新上传")},onSubmit:function(){var t=this;return(0,i.default)(o.default.mark((function e(){var a,i;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=void 0,i=(0,n.default)({},t.formData,{isTop:t.formData.isTop?1:0,status:t.formData.status?1:0}),!t.formData.id){e.next=8;break}return e.next=5,t.$api.wechatShareTaskSubjects.update(i);case 5:a=e.sent,e.next=11;break;case 8:return e.next=10,t.$api.wechatShareTaskSubjects.insert(i);case 10:a=e.sent;case 11:1==a.code?(t.$toast.success("提交成功"),1==t.formData.status?t.$dialog.confirm({title:"提示",message:"是否立即发布专栏文章",confirmButtonText:"发布文章"}).then((function(e){return t.$router.replace({name:"ArticlePublish",query:{columnId:a.data.id}})})).catch((function(e){"cancel"==e&&t.$router.go(-1)})):t.$router.go(-1)):t.$toast.failure(a.message);case 12:case"end":return e.stop()}}),e,t)})))()}}}}}]);