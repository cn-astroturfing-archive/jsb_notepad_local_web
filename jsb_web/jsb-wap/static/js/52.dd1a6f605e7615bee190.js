(window.webpackJsonp=window.webpackJsonp||[]).push([[52],{"4c9D":function(t,e,n){"use strict";n("dZPI")},RxDp:function(t,e,n){"use strict";n.r(e);var o=n("hyup"),i=n.n(o);for(var r in o)["default"].indexOf(r)<0&&function(t){n.d(e,t,(function(){return o[t]}))}(r);e.default=i.a},dZPI:function(t,e,n){},hyup:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=u(n("cLjf")),i=u(n("hDQ3")),r=n("mS6s"),a=u(n("3vVk"));function u(t){return t&&t.__esModule?t:{default:t}}e.default={components:{VueEditor:r.VueEditor,UploadTip:a.default},data:function(){return{content:"",customToolbar:[{align:""},{align:"center"},{align:"right"},"bold","italic","image","video"],uploadTypeOpts:{title:"上传图片方式",list:[{label:"photo",value:"相册"}],showCancelButton:!1,showConfirmButton:!1},disabledSubmitBtn:!1,showUploadPop:null,uploadOptions:{},interfaceType:null}},mounted:function(){var t=this;this.$refs.editor.$refs.fileInput.type="button",this.$refs.editor.$refs.fileInput.onclick=function(){t.resourceChoose("img")},document.querySelector(".ql-toolbar .ql-video").onclick=function(){t.resourceChoose("video")},this.$refs.editor.$el.style.height=(this.pageOffsetHeight||document.body.offsetHeight)/2+"px"},methods:{onClickLeft:function(){this.$router.go(-1)},resourceChoose:function(t){var e=this;this.$nextTick((function(){e.$refs.input.focus(),setTimeout((function(){e.$refs.input.blur()}),0)})),this.resourceAdd(t)},resourceAdd:function(t){var e=this;return(0,i.default)(o.default.mark((function n(){return o.default.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:e.interfaceType=t,e.uploadOptions={type:"photo",interface_type:t,form_source:"5"},e.showUploadPop=Math.random();case 3:case"end":return n.stop()}}),n,e)})))()},uploadCallback:function(t){var e=t.code,n=t.data,o=t.message;if(e&&1==e&&n.filePath){var i=this.$refs.editor.quill,r=i.getSelection(!0).index;"video"===this.interfaceType?i.insertEmbed(r,"video",n.filePath):i.insertEmbed(r,"image",n.filePath),i.setSelection(r+1),this.handleContentPlusSymbol()}else this.$toast.fail(o||"上传失败, 请重新上传")},handleContentPlusSymbol:function(){var t=/<[^>]*\s+src=["\']([^"\']+)["\']/gi,e=this.content.match(t)||[],n=e.length;if(!(n<=0))for(var o=0;o<n;o++){var i=e[o];if(i.indexOf("+")>-1){var r=t.exec(i);r&&(this.content=this.content.replace(r[1],r[1].replace(/\+/g,"%2B")))}}},vueEditorSelectionChange:function(t,e){this.rangIndex=(e||{}).index||0},vueEditorFocus:function(t){if(this.isIOS){for(var e=this.$refs.editor.$refs.quillContainer.querySelector(".ql-editor").children,n=e[e.length-1],o=n.offsetHeight;"app"!==n.id;)o+=n.offsetTop||0,n=n.parentNode;window.scrollTo(0,o)}},vueEditorBlur:function(){this.isIOS&&window.scrollTo(0,1e5)},onSubmit:function(t){var e=this;return(0,i.default)(o.default.mark((function t(){return o.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.content){t.next=3;break}return e.$toast.fail("请填写内容"),t.abrupt("return");case 3:if(!e.disabledSubmitBtn){t.next=5;break}return t.abrupt("return");case 5:return e.disabledSubmitBtn=!0,t.prev=6,t.next=9,e.$api.base.replyFeedback({feedbackId:e.$route.query.feedbackId,replyContent:e.content,userType:2});case 9:t.next=15;break;case 11:return t.prev=11,t.t0=t.catch(6),e.disabledSubmitBtn=!1,t.abrupt("return");case 15:setTimeout((function(){e.$toast.loading({message:"内容补充完成，我们会尽快处理",duration:0,icon:"success"}),setTimeout((function(){e.disabledSubmitBtn=!1,e.content="",e.$toast.clear(),e.$router.go(-1)}),2e3)}),500);case 16:case"end":return t.stop()}}),t,e,[[6,11]])})))()}}}},nZQu:function(t,e,n){"use strict";n.d(e,"a",(function(){return o})),n.d(e,"b",(function(){return i}));var o=function(){var t=this,e=t._self._c;return e("div",{staticClass:"feedback_container nav_outer_div"},[e("van-nav-bar",{attrs:{title:t.$route.meta.title,"left-arrow":"","right-text":"  ",fixed:""},on:{"click-left":t.onClickLeft}}),t._v(" "),e("van-form",{on:{submit:t.onSubmit}},[e("van-cell-group",{staticClass:"group_content",attrs:{title:"填写内容",border:!1}},[e("vue-editor",{ref:"editor",attrs:{editorToolbar:t.customToolbar,placeholder:"请输入反馈内容，如遇到无法使用等问题请反馈使用的机型、系统版本等信息。\n\n注意：您反馈的内容应为功能使用方面的问题或意见建议，不能涉及敏感信息或敏感关键字，否则系统会自动屏蔽。",useCustomImageHandler:""},on:{"selection-change":t.vueEditorSelectionChange,focus:t.vueEditorFocus,blur:t.vueEditorBlur},model:{value:t.content,callback:function(e){t.content=e},expression:"content"}}),t._v(" "),e("input",{ref:"input",staticStyle:{"pointer-events":"none"},attrs:{type:"text"}})],1),t._v(" "),e("div",{staticClass:"bottom_btns"},[e("van-button",{attrs:{type:"info",block:"","native-type":"submit",disabled:t.disabledSubmitBtn}},[t._v("提交")])],1)],1),t._v(" "),e("UploadTip",{attrs:{uploadOptions:t.uploadOptions,uploadCallback:t.uploadCallback},model:{value:t.showUploadPop,callback:function(e){t.showUploadPop=e},expression:"showUploadPop"}})],1)},i=[]},qN3h:function(t,e,n){"use strict";n.r(e);var o=n("nZQu"),i=n("RxDp");for(var r in i)["default"].indexOf(r)<0&&function(t){n.d(e,t,(function(){return i[t]}))}(r);n("4c9D");var a=n("gp09"),u=Object(a.a)(i.default,o.a,o.b,!1,null,null,null);e.default=u.exports}}]);